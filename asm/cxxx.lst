
; ******** Source: cxxx.s
     1                          * = $6000
     2                          currentTest = $03
     3                          add = $04
     4                          expected = $06
     5                          
     6                          
     7                          start:
     8                              ;; Test 15
     9  6000 a915                   lda #$15
    10  6002 8503                   sta currentTest
    11  6004 205a60                 jsr reset
    12  6007 207f60                 jsr c8rom
    13  600a b055                   bcs fail
    14  600c 206460                 jsr c1rom
    15  600f b050                   bcs fail
    16  6011 206d60                 jsr c4rom
    17  6014 b04b                   bcs fail
    18  6016 207660                 jsr c3rom
    19  6019 9046                   bcc fail
    20                          
    21                              ;; Test 16
    22  601b a916                   lda #$16
    23  601d 8503                   sta currentTest
    24  601f 205a60                 jsr reset
    25  6022 8d0bc0                 sta $c00b  ;; set slotC3Rom
    26  6025 207f60                 jsr c8rom
    27  6028 b037                   bcs fail
    28  602a 206460                 jsr c1rom
    29  602d b032                   bcs fail
    30  602f 206d60                 jsr c4rom
    31  6032 b02d                   bcs fail
    32  6034 207660                 jsr c3rom
    33  6037 b028                   bcs fail
    34                          
    35                              ;; test 17
    36                              ;; expect all ROM
    37  6039 a917                   lda #$17
    38  603b 8503                   sta currentTest
    39  603d 205a60                 jsr reset
    40  6040 8d07c0                 sta $c007  ;; set intCxRom -> everything should go to internal
    41  6043 207f60                 jsr c8rom
    42  6046 9019                   bcc fail
    43  6048 206460                 jsr c1rom
    44  604b 9014                   bcc fail
    45  604d 206d60                 jsr c4rom
    46  6050 900f                   bcc fail
    47  6052 207660                 jsr c3rom
    48  6055 900a                   bcc fail
    49                          
    50  6057 a503                   lda currentTest
    51  6059 60                     rts
    52                          
    53                          reset:
    54  605a 8d06c0                 sta $c006
    55  605d 8d0ac0                 sta $c00a
    56  6060 60                     rts
    57                          
    58                          fail:
    59  6061 a503                   lda currentTest
    60  6063 00                     brk
    61                          
    62                          ; if Carry is set, C1 is ROM
    63                          c1rom:
    64  6064 ad4dc1                 lda $c14d
    65  6067 c9a5                   cmp #$a5
    66  6069 f001                   beq +
    67  606b 18                     clc
    68                          +
    69  606c 60                     rts
    70                          
    71                          c4rom:
    72  606d ad36c4                 lda $c436
    73  6070 c98d                   cmp #$8d
    74  6072 f001                   beq +
    75  6074 18                     clc
    76                          +
    77  6075 60                     rts
    78                          
    79                          c3rom:
    80  6076 ad00c3                 lda $c300
    81  6079 c92c                   cmp #$2c
    82  607b f001                   beq +
    83  607d 18                     clc
    84                          +
    85  607e 60                     rts
    86                          
    87                          c8rom:
    88  607f ad00c8                 lda $c800
    89  6082 c94c                   cmp #$4c
    90  6084 f001                   beq +
    91  6086 18                     clc
    92                          +
    93  6087 60                     rts
    94                          
    95                          
    96                          
    97                          test:
    98  6088 a000                   ldy #$0
    99  608a ada560                 lda .cxtestdata
   100  608d 8504                   sta add
   101  608f ada660                 lda .cxtestdata+1
   102  6092 8505                   sta add+1
   103  6094 ada760                 lda .cxtestdata+2
   104  6097 8506                   sta expected
   105                          
   106                          loop:
   107  6099 b104                   lda (add),Y
   108  609b c506                   cmp expected
   109  609d d0c2                   bne fail
   110  609f c8                     iny
   111  60a0 c005                   cpy #5
   112  60a2 90f5                   bcc loop
   113  60a4 60                     rts
   114                          
   115                          .cxtestdata
   116                          	;; C800-Cffe
   117  60a5 00c84c             	!byte $00, $c8, $4c
   118  60a8 21ca8d             	!byte $21, $ca, $8d
   119  60ab 43ccf0             	!byte $43, $cc, $f0
   120  60ae b5ce7b             	!byte $b5, $ce, $7b
   121                          
   122                          	;; C100-C2ff
   123  60b1 4dc1a5             	!byte $4d, $c1, $a5
   124  60b4 6cc12a             	!byte $6c, $c1, $2a
   125  60b7 b5c2ad             	!byte $b5, $c2, $ad
   126  60ba ffc200             	!byte $ff, $c2, $00
   127                          
   128                          	;; C400-C7ff
   129  60bd 36c48d             	!byte $36, $c4, $8d
   130  60c0 48c518             	!byte $48, $c5, $18
   131  60c3 80c68b             	!byte $80, $c6, $8b
   132  60c6 6ec7cb             	!byte $6e, $c7, $cb
   133                          
   134                          	;; C300-C3ff
   135  60c9 00c32c             	!byte $00, $c3, $2c
   136  60cc 0ac30c             	!byte $0a, $c3, $0c
   137  60cf 2bc304             	!byte $2b, $c3, $04
